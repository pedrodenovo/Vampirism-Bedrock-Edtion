function _vp_tb(s){let a="";return s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=13680..}]").successCount?a+="vamp_blood_XX0 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=12960..}]").successCount?a+="vamp_blood_X9 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=12240..}]").successCount?a+="vamp_blood_X8 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=11520..}]").successCount?a+="vamp_blood_X7 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=10800..}]").successCount?a+="vamp_blood_X6 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=10080..}]").successCount?a+="vamp_blood_X5 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=9360..}]").successCount?a+="vamp_blood_X4 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=8640..}]").successCount?a+="vamp_blood_X3 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=7920..}]").successCount?a+="vamp_blood_X2 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=7200..}]").successCount?a+="vamp_blood_X1 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=6480..}]").successCount?a+="vamp_blood_X0 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=5760..}]").successCount?a+="vamp_blood_9 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=5040..}]").successCount?a+="vamp_blood_8 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=4320..}]").successCount?a+="vamp_blood_7 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=1200..}]").successCount?a+="vamp_blood_6 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=3600..}]").successCount?a+="vamp_blood_5 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=2880..}]").successCount?a+="vamp_blood_4 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=2160..}]").successCount?a+="vamp_blood_3 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=1440..}]").successCount?a+="vamp_blood_2 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=2..}]").successCount?a+="vamp_blood_1 ":s.hasTag("vamp")&&1==s.runCommand("testfor @s[m=!c,scores={blood=..1}]").successCount&&(a+="vamp_blood_0 "),a}function _vp_effects(s){let a="";return s.hasTag("timerToVamp")&&1==s.runCommand("testfor @s[scores={timerToVamp=0..1200}]").successCount?a+="timer_max_vamp_effect ":s.hasTag("timerToVamp")&&1==s.runCommand("testfor @s[scores={timerToVamp=1201..}]").successCount&&(a+="timer_1min_vamp_effect "),a}function _calcularDistancia(s,a,o,e,t,m){const n=Math.sqrt(Math.pow(e-s,2)+Math.pow(t-a,2)+Math.pow(m-o,2));return n}function _lv_vamp(s){let a;if(s.hasTag("vamp")){for(const o in tagToLevelMap)if(s.hasTag(o)){a=tagToLevelMap[o];break}return a}}function _bite_display(s){let a;if(s.hasTag("vamp")&&s.getEntitiesFromViewDirection()[0]){let o=s.getEntitiesFromViewDirection()[0].entity.runCommand("testfor @s[family=!hunter,family=mob,family=!monster,family=!vamp,family=!lob]").successCount,e=_calcularDistancia(s.getEntitiesFromViewDirection()[0].entity.location.x,s.getEntitiesFromViewDirection()[0].entity.location.y,s.getEntitiesFromViewDirection()[0].entity.location.z,s.location.x,s.location.y,s.location.z);if(1==o&&e<=3.25)return a=_drainEntityBlood(s.getEntitiesFromViewDirection()[0].entity),a}}function _drainEntityBlood(s){return s.hasTag("drainedBlood_2")?"bite_2_display":s.hasTag("drainedBlood_3")?"bite_3_display":s.hasTag("drainedBlood_4")?"bite_4_display":s.hasTag("drainedBlood_5")?"bite_5_display":s.hasTag("drainedBlood_6")?"":"bite_1_display"}import*as server from"@minecraft/server";import*as skill_screen from"./use_skill_screen.js";const tagToLevelMap={lv_vamp_1:"lv_vamp_1",lv_vamp_2:"lv_vamp_2",lv_vamp_3:"lv_vamp_3",lv_vamp_4:"lv_vamp_4",lv_vamp_5:"lv_vamp_5",lv_vamp_6:"lv_vamp_6",lv_vamp_7:"lv_vamp_7",lv_vamp_8:"lv_vamp_8",lv_vamp_9:"lv_vamp_9",lv_vamp_10:"lv_vamp_x0",lv_vamp_11:"lv_vamp_x1",lv_vamp_12:"lv_vamp_x2",lv_vamp_13:"lv_vamp_x3",lv_vamp_14:"lv_vamp_x4"};server.system.runInterval(s=>{var a=server.world.getAllPlayers();a.forEach(s=>{let a=_bite_display(s),o=_lv_vamp(s),e=_vp_effects(s),t=_vp_tb(s);s.runCommand("title @s times 0 0 0"),s.runCommand(`title @s title ${a} ${o} ${e} ${t} x`),s.isSneaking&&s.hasTag("disable_item_skill")&&s.hasTag("vamp")&&0==s.hasTag("next_isSneaking")?(s.addTag("next_isSneaking"),server.system.runTimeout(a=>{s.removeTag("next_isSneaking")},7)):0==s.isSneaking&&s.hasTag("disable_item_skill")&&s.hasTag("vamp")&&1==s.hasTag("next_isSneaking")?(s.addTag("next_isSneaking_I"),server.system.runTimeout(a=>{s.removeTag("next_isSneaking_I")},7)):s.isSneaking&&s.hasTag("disable_item_skill")&&s.hasTag("vamp")&&1==s.hasTag("next_isSneaking_I")&&skill_screen.open_screen_for(s)})},1);