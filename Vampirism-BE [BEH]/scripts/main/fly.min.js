import{world as i,system as n}from"@minecraft/server";import*as s from"./fly.config.js";let config=s.config,fly_speed=config.fly_speed;function fly(i){let n=new t(.5*i.getViewDirection().x,.5*i.getViewDirection().y,.5*i.getViewDirection().z);i.applyKnockback(converterValor(n.x),converterValor(n.z),1*fly_speed,1*converterValorComSmooth(n.y)),i.runCommand("effect @s slow_falling 1 0 true")}function stop_fly(i){config.fly_fall?(i.applyKnockback(0,0,0,-.0385*fly_speed),i.runCommand("effect @s slow_falling 1 0 true")):(i.applyKnockback(0,0,0,.0385),i.runCommand("effect @s slow_falling 1 0 true"))}config.fly_just_on_hold_jump?"hold_jump"==config.fly_mode?n.runInterval(s=>{i.getAllPlayers().forEach(i=>{i.isJumping&&n.runTimeout(n=>{i.isJumping&&fly(i)},15)})},1):"hold_jump_and_tag"==config.fly_mode?n.runInterval(s=>{i.getAllPlayers().forEach(i=>{i.isJumping&&i.hasTag(config.fly_tag)&&n.runTimeout(n=>{i.isJumping&&fly(i)},15)})},1):"on_item"==config.fly_mode?n.runInterval(s=>{i.getAllPlayers().forEach(i=>{1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.weapon.mainhand}]").successCount&&i.isJumping&&n.runTimeout(n=>{i.isJumping&&fly(i)},15)})},1):"on_item_and_tag"==config.fly_mode?n.runInterval(s=>{i.getAllPlayers().forEach(i=>{1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.weapon.mainhand}]").successCount&&i.isJumping&&i.hasTag(config.fly_tag)&&n.runTimeout(n=>{i.isJumping&&fly(i)},15)})},1):"on_item_equip"==config.fly_mode&&n.runInterval(s=>{i.getAllPlayers().forEach(i=>{1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.weapon.offhand,quantity=1}]").successCount&&i.isJumping?n.runTimeout(n=>{i.isJumping&&fly(i)},15):1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.armor.head,quantity=1}]").successCount&&i.isJumping?n.runTimeout(n=>{i.isJumping&&fly(i)},15):1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.armor.chest,quantity=1}]").successCount&&i.isJumping?n.runTimeout(n=>{i.isJumping&&fly(i)},15):1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.armor.legs,quantity=1}]").successCount&&i.isJumping?n.runTimeout(n=>{i.isJumping&&fly(i)},15):1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.armor.feet,quantity=1}]").successCount&&i.isJumping&&n.runTimeout(n=>{i.isJumping&&fly(i)},15)})},1):"hold_jump"==config.fly_mode?n.runInterval(s=>{i.getAllPlayers().forEach(i=>{i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15)})},1):"hold_jump_and_tag"==config.fly_mode?n.runInterval(s=>{i.getAllPlayers().forEach(i=>{i.hasTag(config.fly_tag)&&(i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15))})},1):"on_item"==config.fly_mode?n.runInterval(s=>{i.getAllPlayers().forEach(i=>{1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.weapon.mainhand}]").successCount?(i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15)):i.removeTag("api_is_flying")})},1):"on_item_and_tag"==config.fly_mode?n.runInterval(s=>{i.getAllPlayers().forEach(i=>{i.hasTag(config.fly_tag)&&1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.weapon.mainhand}]").successCount?(i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15)):i.removeTag("api_is_flying")})},1):"on_item_equip"==config.fly_mode&&n.runInterval(s=>{i.getAllPlayers().forEach(i=>{1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.weapon.offhand,quantity=1}]").successCount?(i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15)):1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.armor.head,quantity=1}]").successCount?(i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15)):1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.armor.chest,quantity=1}]").successCount?(i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15)):1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.armor.legs,quantity=1}]").successCount?(i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15)):1==i.runCommand("testfor @s[hasitem={item="+config.fly_item+",location=slot.armor.feet,quantity=1}]").successCount?(i.isOnGround&&i.hasTag("api_is_flying")&&!i.isJumping&&!i.isSprinting&&i.removeTag("api_is_flying"),i.isJumping&&!i.isSprinting&&n.runTimeout(n=>{i.isJumping&&i.addTag("api_is_flying")},15),i.hasTag("api_is_flying")&&n.runTimeout(n=>{i.isJumping?fly(i):stop_fly(i)},15)):i.removeTag("api_is_flying")})},1);export default class t{#a;#b;#c;constructor(i,n,s){this.#a=i,this.#b=n,this.#c=s}length(){return Math.sqrt(this.#a*this.#a+this.#b*this.#b+this.#c*this.#c)}normalized(){let i=1/(this.length()||1);return this.#a*=i,this.#b*=i,this.#c*=i,this}static add(i,n){return new t(i.x+n.x,i.y+n.y,i.z+n.z)}static subtract(i,n){return new t(i.x-n.x,i.y-n.y,i.z-n.z)}static multiply(i,n){return new t(i.x*n,i.y*n,i.z*n)}static divide(i,n){return new t(i.x/n.x,i.y/n.y,i.z/n.z)}static distance(i,n){return Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)+Math.pow(i.z-n.z,2))}get x(){return this.#a}get y(){return this.#b}get z(){return this.#c}};function converterValor(i){return -90+(i- -1)*180/2}function converterValorComSmooth(i){return .1>=Math.abs(i)?.0375:i<-.1?(i+.1)*fly_speed*1.3:(i-.1)*fly_speed*1.3}