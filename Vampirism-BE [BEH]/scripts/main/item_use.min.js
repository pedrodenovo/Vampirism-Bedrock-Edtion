function calcularDistancia(o,e,s,t,n,r){const i=Math.sqrt(Math.pow(t-o,2)+Math.pow(n-e,2)+Math.pow(r-s,2));return i}function drainEntityBlood(o){o.hasTag("drainedBlood_2")?(o.runCommandAsync("tag @s add drainedBlood_3"),o.runCommandAsync("tag @s remove drainedBlood_2")):o.hasTag("drainedBlood_3")?(o.runCommandAsync("tag @s add drainedBlood_4"),o.runCommandAsync("tag @s remove drainedBlood_3")):o.hasTag("drainedBlood_4")?(o.runCommandAsync("tag @s add drainedBlood_5"),o.runCommandAsync("tag @s remove drainedBlood_4")):o.hasTag("drainedBlood_5")?(o.runCommandAsync("tag @s remove drainedBlood_5"),o.runCommandAsync("tag @s add drainedBlood_6"),o.runCommandAsync("kill @s")):o.runCommandAsync("tag @s add drainedBlood_2")}import*as server from"@minecraft/server";import*as skill_screen from"./use_skill_screen.js";const blood_bottleMap=["sunrise:blood_bottle_0","sunrise:blood_bottle_1","sunrise:blood_bottle_2","sunrise:blood_bottle_3","sunrise:blood_bottle_4","sunrise:blood_bottle_5","sunrise:blood_bottle_6","sunrise:blood_bottle_7","sunrise:blood_bottle_8","sunrise:blood_bottle_9"];server.world.afterEvents.itemUse.subscribe(o=>{if(o.source.runCommand("gamerule sendCommandFeedback false"),o.source.getEntitiesFromViewDirection()[0]){let e=blood_bottleMap.indexOf(o.itemStack.typeId),s=o.source.getEntitiesFromViewDirection()[0].entity.runCommand("testfor @s[family=mob,family=!monster,family=!vamp,family=!lob]").successCount,t=o.source.getEntitiesFromViewDirection()[0]&&calcularDistancia(o.source.getEntitiesFromViewDirection()[0].entity.location.x,o.source.getEntitiesFromViewDirection()[0].entity.location.y,o.source.getEntitiesFromViewDirection()[0].entity.location.z,o.source.location.x,o.source.location.y,o.source.location.z);1==s&&e>=0&&o.source.isSneaking&&o.source.hasTag("vamp")&&!o.source.hasTag("disable_auto_blood_fill")&&t<=3.25?1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_8}]").successCount?(o.source.runCommandAsync("clear @s sunrise:blood_bottle_8 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_9 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_7}]").successCount?(o.source.runCommandAsync("clear @s sunrise:blood_bottle_7 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_8 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_6}]").successCount?(o.source.runCommandAsync("clear @s sunrise:blood_bottle_6 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_7 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_5}]").successCount?(o.source.runCommandAsync("clear @s sunrise:blood_bottle_5 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_6 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_4}]").successCount?(o.source.runCommandAsync("clear @s sunrise:blood_bottle_4 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_5 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_3}]").successCount?(o.source.runCommandAsync("clear @s sunrise:blood_bottle_3 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_4 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_2}]").successCount?(o.source.runCommandAsync("clear @s sunrise:blood_bottle_2 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_3 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_1}]").successCount?(o.source.runCommandAsync("clear @s sunrise:blood_bottle_1 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_2 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==o.source.runCommand("testfor @s[hasitem={item=sunrise:blood_bottle_0}]").successCount&&(o.source.runCommandAsync("clear @s sunrise:blood_bottle_0 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_1 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==s&&9==!e&&e>=0&&o.source.isSneaking&&o.source.hasTag("disable_auto_blood_fill")&&o.source.hasTag("vamp")&&t<=3.25?(o.source.runCommandAsync(`clear @s ${blood_bottleMap[e]} 0 1`),o.source.runCommandAsync(`give @s sunrise:blood_bottle_${e+1} 1`),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):o.source.isSneaking&&o.source.hasTag("vamp")&&t<=3.25&&"minecraft:glass_bottle"==o.itemStack.typeId?(o.source.runCommandAsync("clear @s glass_bottle 0 1"),o.source.runCommandAsync("give @s sunrise:blood_bottle_1 1"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity)):1==s&&o.source.isSneaking&&o.source.hasTag("vamp")&&t<=3.25&&(o.source.runCommandAsync("scoreboard players add @s blood 480"),drainEntityBlood(o.source.getEntitiesFromViewDirection()[0].entity))}if(o.source.getBlockFromViewDirection()&&o.source.getBlockFromViewDirection().block){let e=o.source.getBlockFromViewDirection().block.location,s=o.source.location;calcularDistancia(s.x,s.y,s.z,e.x,e.y,e.z)<=5&&(1==o.source.runCommand(`testforblock ${e.x} ${e.y} ${e.z} sunrise:cursed_grass_block`).successCount?o.itemStack.typeId.includes("_shovel")&&o.source.runCommand(`setblock ${e.x} ${e.y} ${e.z} sunrise:cursed_earth_path`):o.source.hasTag("vamp")&&0==o.source.hasTag("lv_vamp_14")&&"sunrise:blood_bottle_9"==o.itemStack.typeId&&1==o.source.runCommand(`testforblock ${e.x} ${e.y} ${e.z} sunrise:altar_inspiration_full`).successCount&&skill_screen.unlock_skill_for(o.source,e))}if("sunrise:vampire_skill_item"==o.itemStack.typeId){let e=o.source;skill_screen.open_screen_for(e)}});